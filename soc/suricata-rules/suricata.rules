# Example Suricata rules for CyberBlue SOC Platform
# This file contains basic security rules for demonstration

# Drop all traffic from external networks to port 22 (SSH)
drop tcp any any -> any 22 (msg:"SSH access attempt"; sid:1000001; rev:1;)

# Alert on suspicious HTTP traffic
alert http any any -> any any (msg:"Suspicious HTTP request"; content:"admin"; http_uri; sid:1000002; rev:1;)

# Detect potential SQL injection
alert tcp any any -> any 80 (msg:"Possible SQL injection attempt"; content:"UNION SELECT"; nocase; sid:1000003; rev:1;)

# Monitor DNS traffic
alert udp any any -> any 53 (msg:"DNS query"; sid:1000004; rev:1;)

# Alert on ICMP traffic (ping scans)
alert icmp any any -> any any (msg:"ICMP ping"; itype:8; sid:1000005; rev:1;)

# Detect large HTTP POST requests (potential file upload)
alert http any any -> any any (msg:"Large HTTP POST"; content-length:>10000; sid:1000006; rev:1;)

# Monitor for SSL/TLS handshake failures
alert tcp any any -> any 443 (msg:"SSL handshake failure"; ssl_state:client_hello; sid:1000007; rev:1;)

# Detect potential brute force attacks on SSH
alert tcp any any -> any 22 (msg:"SSH brute force attempt"; threshold:type threshold, track by_src, count 5, seconds 60; sid:1000008; rev:1;)

# Alert on unusual port scanning
alert tcp any any -> any any (msg:"Port scan detected"; flags:S; threshold:type both, track by_src, count 10, seconds 60; sid:1000009; rev:1;)

# Monitor for suspicious file transfers
alert tcp any any -> any 21 (msg:"FTP file transfer"; sid:1000010; rev:1;)