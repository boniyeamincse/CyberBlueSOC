%YAML 1.1
---

# Suricata configuration file. In addition to the comments describing all
# options in this file, full documentation can be found at:
# https://suricata.readthedocs.io/en/latest/configuration/suricata-yaml.html

# Number of packets allowed to be processed simultaneously.  Default is a
# conservative 1024. A higher number will make sure CPU will be better utilized,
# but may negatively impact caching.
max-pending-packets: 1024

# Runmode the engine should use. Please check --list-runmodes to get the available
# runmodes for each packet acquisition method. Defaults to "autofp" (auto flow pinned
# load balancing).
runmode: autofp

# Default pid file.
pid-file: /var/run/suricata.pid

# Daemon working directory
# Suricata will change directory to this one if provided
# Default: "/var/run/"
#daemon-directory: "/var/run/"

# Preallocated size for packet. Default is 1514 which is the classical
# size for pcap on ethernet. You should adjust this value to the highest
# packet size (MTU + hardware header) on your system.
default-packet-size: 1514

# The default logging directory.  Any log or output file will be
# placed here if its not specified with a full path name. This can be
# overridden with the -l command line parameter.
default-log-dir: /var/log/suricata

# Unix command socket can be used to pass commands to suricata.
# An external tool can then connect to get information from suricata
# or trigger some modifications of the engine. Set enabled to yes
# to activate the feature. You can use the filename variable to set
# the file name of the socket.
unix-command:
  enabled: no
  #filename: custom.socket

# Configure the type of alert (and other) logging you would like.
outputs:

  - eve-log:
      enabled: yes
      filename: eve.json
      # Enable for multi-threaded eve.json output; output files are amended with
      # either the CPU or the host name (if no CPU info is available)
      #threaded: false
      #prefix: "@cee: "
      # the following are valid when type: syslog above
      #identity: "suricata"
      #facility: local5
      #level: Info ## possible levels: Emergency, Alert, Critical,
                   ## Error, Warning, Notice, Info, Debug
      #ethernet: no  # log ethernet header in events when available
      types:
        - alert:
            # payload: yes             # enable dumping payload in Base64
            # payload-buffer-size: 4kb # max size of payload buffer to output in eve-log
            # payload-printable: yes   # enable dumping payload in printable (lossy) format
            # packet: yes              # enable dumping of packet (without stream segments)
            # http-body: yes           # enable dumping of http body in Base64
            # http-body-printable: yes # enable dumping of http body in printable format
            # tagged-packets: yes      # enable logging of tagged packets for rules
                                       # that have tagged_packed enabled
            metadata: yes              # enable inclusion of app layer metadata with alert
            # xff:
            #   enabled: no
            #   mode: extra-data
            #   deployment: reverse
            #   header: X-Forwarded-For
        - http:
            extended: yes     # enable this for extended logging information
            # custom: yes     # enable the custom logging format (defined by custom format)
            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i -> %{dst}i code %s req %m %H %B"
            # resp-include-body: no
            # req-include-body: no
            # dump-all-headers: no
        - dns:
            version: 2
        - tls:
            extended: yes     # enable this for extended logging information
            # custom: yes     # enable the custom logging format (defined by custom format)
            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i -> %{dst}i %s %B"
        - files:
            force-magic: no   # force logging magic on all logged files
            # force-md5: no   # force logging of md5 checksums
        - smtp:
            extended: yes # enable this for extended logging information
            # this includes: bcc, message-id, subject, x_mailer, user-agent
            # custom: yes    # enable the custom logging format (defined by custom format)
            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i -> %{dst}i code %s req %m %H"
        - ssh
        - stats:
            totals: yes       # stats for all threads merged together
            threads: no       # per thread stats
            deltas: no        # include delta values
        - flow
        - netflow
        - dhcp:
            enabled: no
            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i %{dst}i %{len}i %{client_ip}i %{client_mac}i %{assigned_ip}i %{lease_time}i"
        - anomaly:
            enabled: yes
            types:
              decode: yes
              stream: yes
              applayer: yes
        # bi-directional flows
        - biflow:
            enabled: yes

# Configure the type of alert (and other) logging you would like.
#outputs:
#
#  # a line based alerts log similar to Snort's fast.log
#  - fast:
#      enabled: yes
#      filename: fast.log
#      append: yes    # append to file (default) or overwrite file
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#
#  # Extensible Event Format (nicknamed EVE) event log in JSON format
#  - eve-log:
#      enabled: yes
#      filetype: regular #regular|syslog|unix_dgram|unix_socket|redis
#      filename: eve.json
#      # Enable for multi-threaded eve.json output; output files are amended with
#      # either the CPU or the host name (if no CPU info is available)
#      #threaded: false
#      #prefix: "@cee: "
#      # the following are valid when type: syslog above
#      #identity: "suricata"
#      #facility: local5
#      #level: Info ## possible levels: Emergency, Alert, Critical,
#                   ## Error, Warning, Notice, Info, Debug
#      #ethernet: no  # log ethernet header in events when available
#      types:
#        - alert:
#            # payload: yes             # enable dumping payload in Base64
#            # payload-buffer-size: 4kb # max size of payload buffer to output in eve-log
#            # payload-printable: yes   # enable dumping payload in printable (lossy) format
#            # packet: yes              # enable dumping of packet (without stream segments)
#            # http-body: yes           # enable dumping of http body in Base64
#            # http-body-printable: yes # enable dumping of http body in printable format
#            # tagged-packets: yes      # enable logging of tagged packets for rules
#                                       # that have tagged_packed enabled
#            metadata: yes              # enable inclusion of app layer metadata with alert
#            # xff:
#            #   enabled: no
#            #   mode: extra-data
#            #   deployment: reverse
#            #   header: X-Forwarded-For
#        - http:
#            extended: yes     # enable this for extended logging information
#            # custom: yes     # enable the custom logging format (defined by custom format)
#            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i -> %{dst}i code %s req %m %H %B"
#            # resp-include-body: no
#            # req-include-body: no
#            # dump-all-headers: no
#        - dns:
#            version: 2
#        - tls:
#            extended: yes     # enable this for extended logging information
#            # custom: yes     # enable the custom logging format (defined by custom format)
#            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i -> %{dst}i %s %B"
#        - files:
#            force-magic: no   # force logging magic on all logged files
#            # force-md5: no   # force logging of md5 checksums
#        - smtp:
#            extended: yes # enable this for extended logging information
#            # this includes: bcc, message-id, subject, x_mailer, user-agent
#            # custom: yes    # enable the custom logging format (defined by custom format)
#            # customformat: "%{%D-%H:%M:%S}t.%z %{src}i -> %{dst}i code %s req %m %H"
#        - ssh
#        - stats:
#            totals: yes       # stats for all threads merged together
#            threads: no       # per thread stats
#            deltas: no        # include delta values
#        - flow
#        # bi-directional flows
#        - biflow:
#            enabled: yes
#        # Anomaly detection
#        - anomaly:
#            enabled: yes
#            types:
#              decode: yes
#              stream: yes
#              applayer: yes
#
#  # alert output for use with Barnyard2
#  - unified2-alert:
#      enabled: no
#      filename: unified2.alert
#
#      # File size limit.  Can be specified in kb, mb, gb.  Just a number
#      # is parsed as bytes.
#      #limit: 32mb
#
#      # Sensor ID field of unified2 alerts.
#      #sensor-id: 0
#
#      # HTTP X-Forwarded-For support by adding the unified2 extra header
#      # containing the X-Forwarded-For IP address if present
#      #xff:
#      #  enabled: no
#      #  mode: extra-data
#      #  deployment: reverse
#      #  header: X-Forwarded-For
#
#  # a line based log of HTTP requests (no alerts)
#  - http-log:
#      enabled: no
#      filename: http.log
#      append: yes
#      #extended: yes     # enable this for extended logging information
#      #custom: yes       # enable the custom logging format (defined by custom format)
#      #customformat: "%{%D-%H:%M:%S}t.%z %{host}i %{src}i %{method}i %{uri}i %{status}i %{content-length}i"
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#
#  # a line based log of TLS handshake parameters (no alerts)
#  - tls-log:
#      enabled: no  # Log TLS connections.
#      filename: tls.log # File name to write to.
#      append: yes
#      #extended: yes # Log extended information like fingerprint
#      #custom: yes   # enable the custom logging format (defined by custom format)
#      #customformat: "%{%D-%H:%M:%S}t.%z %{src}i %{dst}i %{tls.version}i %{tls.fingerprint}i"
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#      # session-resumption: no # Log session resumptions
#
#  # output module to store files to disk
#  # Note: the files are logged to the default log dir
#  # i.e. the default log dir + files.json
#  - file-store:
#      version: 2
#      enabled: no
#      # set base directory for storing files
#      #directory: /var/log/suricata/files
#      # set log filename for file logging, feature is enabled if set
#      #filename: files-json.log
#
#      # force logging of checksums, available hash functions are md5,
#      # sha1 and sha256
#      #force-hash: [md5]
#
#  # output for logging files to a socket (for external storage)
#  - file-store:
#      enabled: no
#      # set base directory for storing files
#      #directory: /var/log/suricata/files
#      # set log filename for file logging, feature is enabled if set
#      #filename: files-json.log
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#      force-hash: [md5]
#
#  # a line based log of DNS requests and/or replies (no alerts)
#  - dns-log:
#      enabled: no
#      filename: dns.log
#      append: yes
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#
#  # Packet log in pcap format. 3 modes of operation: "normal"
#  # "multi" and "sguil".
#  #
#  # In normal mode a new file a written for each alert
#  # In multi mode, a new file is written each time a packet is
#  # stored. (Tasked asked)
#  # In sguil mode "single" files are created according to the
#  # sguil naming convention: timestamp.sid.source.
#  # (e.g. 2005-01-24_19.03.13.013448.000000001.1.alert.pcap)
#  # Also an associated .full.pcap file is created for each .alert.pcap
#  # when there are multiple packets that are stored for a single alert.
#  - pcap-log:
#      enabled: no
#      filename: log.pcap
#
#      # File size limit.  Can be specified in kb, mb, gb.  Just a number
#      # is parsed as bytes.
#      #limit: 32mb
#
#      # If set to a value will enable continuous pcap logging.  Files are
#      # rotated as needed.  Names use the following timestamp format:
#      # %timestamp.%interface.%thread
#      #continuous: no
#
#      # File size limit.  Can be specified in kb, mb, gb.  Just a number
#      # is parsed as bytes.
#      #max-filesize: 100mb
#
#      # An alert packet will be written to a separate pcap if the action
#      # is drop or reject.  All packets written to the pcap have the same
#      # alert.
#      #honor-pass-rules: no
#
#      # Maximum size of a drop pcap
#      #max-snaplen: 262144
#
#      # Sguil mode of operation
#      #sguil:
#      #  enabled: no
#      #  data-type: full
#
#      # TCP stream reassembly.  For alerts, a complete session will be logged
#      # until the session ends or a new alert is triggered.  For flows, only
#      # alerts that occur in the same session.
#      #use-stream-depth: no
#
#      # This will include all packets (not just alerts)
#      #continuous: yes
#
#      # Directory to place pcap files.
#      #dir: /var/log/suricata/files
#
#  # a full alerts log containing much information for signature writers
#  # or for investigating suspected false positives.
#  - alert-debug:
#      enabled: no
#      filename: alert-debug.log
#      append: yes
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#
#  # alert output to prelude (https://www.prelude-siem.org/)
#  - alert-prelude:
#      enabled: no
#      profile: suricata
#      log-packet-content: no
#      log-packet-header: yes
#
#  # Stats.log contains data from various counters of the suricata engine.
#  - stats:
#      enabled: yes
#      filename: stats.log
#      append: yes
#      #totals: yes       # stats for all threads merged together
#      #threads: no       # per thread stats
#      #null-values: yes  # print counters that have value 0
#
#  # a lua script can now process all events as fast as possible
#  - lua:
#      enabled: no
#      scripts-dir: /etc/suricata/lua-output/
#      #scripts:
#      #  - script1.lua
#
#  # deprecated - use lua above
#  - drop:
#      enabled: no
#      filename: drop.log
#      append: yes
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'
#
#  # deprecated - use lua above
#  - collect:
#      enabled: no
#      filename: collect.log
#      append: yes
#      #filetype: regular # 'regular', 'unix_socket' or 'unix_dgram'

# a rule reload facility
#rule-reload: true

# If set to yes, the loading of signatures will be made after the capture
# is started. This will limit the downtime in IPS mode.
delayed-detect: yes

# The detection engine builds internal groups of signatures.
# Suricata will use these groups and limit the number of signatures
# it needs to check for each packet. When more groups are specified,
# more memory is used. Default is 2048.
detect-engine:
  - profile: medium
  - custom-values:
      toclient-groups: 3
      toserver-groups: 25
  - sgh-mpm-context: auto
  - inspection-recursion-limit: 3000
  # When rule reloading is enabled, sending a USR2 signal to the Suricata process
  # will trigger a live rule reload. Experimental feature, use with care.
  #- rule-reload: true
  # If set to yes, the order of signatures is changed to improve performance.
  # Default is yes.
  - profiling: yes

# Suricata is multi-threaded. Here the threading can be influenced.
threading:
  set-cpu-affinity: no
  # Tune cpu affinity of suricata threads. Each family of threads can be pinned
  # on specific CPUs.
  #
  # These variables can specify ranges of CPUs in the notation "0-3" or single
  # CPU cores "0,1,2,3". On NetBSD, the CPU cores are grouped and pinned to
  # threads using "cpuset" which is similar to Linux's "taskset".
  #
  #cpu-affinity:
  #  - management-cpu-set:
  #      cpu: [ 0 ]
  #  - receive-cpu-set:
  #      cpu: [ 0 ]
  #  - worker-cpu-set:
  #      cpu: [ "0-3" ]
  #
  # By default Suricata creates one "detect" thread per available CPU/CPU core.
  # This setting allows controlling this behaviour. A value of 0 disables
  # the pinning of detection threads to specific CPUs/CPU cores.
  detect-thread-ratio: 1.0

# Luajit has a strange memory requirement, it's 'states' need to be in the
# first 2G of the process address space. Strange, but luajit does not support
# dynamic loading of .so files outside of the first 2G of address space.
# So by default, on 64bit systems, the base address of the sodu dynamic loader
# mmap call is randomized to have a 50% chance of loading outside of the first
# 2G of address space. Set this to yes to force the sodu dynamic loader to
# load in the first 2G of address space.
#luajit:
#  random-base: no

# Profiling settings. Only effective if Suricata has been built with the
# the --enable-profiling configure flag.
#
profiling:
  # Run profiling for every xth packet. The default is 1, which means we
  # profile every packet. If set to 1000 the engine will profile every 1000th
  # packet.
  #sample-rate: 1000

  # rule profiling
  rules:

    # Profiling can be disabled here, but it will still have a
    # performance impact if compiled in.
    enabled: yes
    filename: rule_perf.log
    append: yes

    # Sort options: ticks, avgticks, checks, matches, maxticks
    sort: avgticks

    # Limit the number of items to print at exit (0 for all).
    limit: 100

  # packet profiling
  packets:

    # Profiling can be disabled here, but it will still have a
    # performance impact if compiled in.
    enabled: yes
    filename: packet_perf.log
    append: yes

    # Limit the number of items to print at exit (0 for all).
    limit: 100

  # profiling of locking. Only available when Suricata has been built with
  # --enable-profiling-locks.
  locks:
    enabled: no
    filename: lock_perf.log
    append: yes

# Suricata can act as a firewall/IPS by dropping, rejecting or passing packets.
# This is a work in progress and therefore experimental code.
#
# ips:
#   engine: nfq
#   #engine: ipfw
#   #engine: pf_ring
#   #engine: netmap
#   #engine: af-packet
#
#   variables:
#     # The default policy (pass/reject/drop)
#     default: pass
#     # The default log action (alert/drop/log)
#     default-log-action: alert
#     # The default log level (alert/critical/error/warning/notice/info/debug)
#     default-log-level: alert
#     # The default action for repeat packets (pass/reject/drop)
#     repeat: pass
#     # The default log action for repeat packets (alert/drop/log)
#     repeat-log-action: alert
#     # The default log level for repeat packets (alert/critical/error/warning/notice/info/debug)
#     repeat-log-level: alert

# NFQ specific variables
#   variables:
#     # NFQ queue number (0-65535)
#     queue-num: 0
#     # NFQ queue fail open (yes/no)
#     fail-open: yes
#     # NFQ repeat queue number (0-65535)
#     repeat-queue-num: 1
#     # NFQ repeat mark (1-65535)
#     repeat-mark: 1
#     # Force the use of NFQ mode (yes/no)
#     force-hash-mode: no
#
# IPFW specific variables
#   variables:
#     # IPFW divert port (0-65535)
#     divert-port: 8000
#     # IPFW divert repeat port (0-65535)
#     repeat-divert-port: 8001
#
# PF_RING specific variables
#   variables:
#     # PF_RING interface name
#     interface: eth0
#     # Number of PF_RING cluster threads
#     threads: 1
#     # PF_RING cluster ID
#     cluster-id: 99
#     # PF_RING cluster type (cluster_flow/cluster_round_robin/cluster_per_flow)
#     cluster-type: cluster_flow
#
# Netmap specific variables
#   variables:
#     # Netmap interface
#     interface: eth0
#   # Number of threads for Netmap
#   threads: 1
#
# AF_PACKET specific variables
#   variables:
#     # AF_PACKET interface
#     interface: eth0
#     # Number of threads for AF_PACKET
#     threads: 1
#     # Ring size in number of packets (default 2048)
#     ring-size: 2048
#     # Block size (default 32768)
#     block-size: 32768
#     # tpacket-v3 block timeout (default 10ms)
#     block-timeout: 10
#     # Use tpacket-v3 (yes/no)
#     use-mmap: yes
#     # tpacket-v3 block size (default 4096)
#     tpacket-v3-block-size: 4096
#     # Number of blocks (default 156)
#     tpacket-v3-num-blocks: 156
#     # Enable copy mode for IPS mode (yes/no)
#     copy-mode: yes
#     # Force setting of number of threads (yes/no)
#     force-set-threads: no
#
# Advanced Capture Options
#   options:
#     # Use buffer size (yes/no)
#     use-buffer-size: yes
#     # Buffer size (default 0)
#     buffer-size: 0
#     # Use packet fanout (yes/no)
#     use-packet-fanout: yes
#     # Packet fanout type (hash/rollover/cpu/lb)
#     packet-fanout-type: hash
#     # Packet fanout mode (hash/rollover/cpu/lb)
#     packet-fanout-mode: hash
#
# Experimental flow bypass
#   bypass: yes
#
#  # Berkeley Packet Filter
#  bpf-filter: "tcp and port 80"
#  # You can have multiple bpfs
#  # bpf-filter:
#  #   - "tcp and port 80"
#  #   - "tcp and port 443"

# Defrag settings:
defrag:
  memcap: 32mb
  hash-size: 65536
  trackers: 65535
  max-frags: 65535
  prealloc: yes
  timeout: 60

# Flow settings:
# By default, the reserved memory (memcap) for flows is 32MB. This is the limit
# for flow allocation inside the engine. You can change this value to allow
# more memory usage for flows.
# The hash-size determines the size of the hash used to identify flows inside
# the engine, and by default the value is 65536.
# At the startup, the engine can preallocate a number of flows, to get a better
# performance. The number of flows preallocated is 10000 by default.
# emergency-recovery is the percentage of flows that the engine need to
# prune before unsetting the emergency state. The emergency state is activated
# when the memcap limit is reached, meaning that it starts to prune flows.
flow:
  memcap: 128mb
  hash-size: 65536
  prealloc: 10000
  emergency-recovery: 30
  #managers: 1
  #recyclers: 1

# Specific timeouts for flows. Here you can specify the timeouts that the
# active flows will wait to transit from the current state to another, on each
# protocol. The value of "new" and "established" are in seconds.
flow-timeouts:

  default:
    new: 30
    established: 300
    closed: 0
    bypassed: 100
    emergency-new: 10
    emergency-established: 100
    emergency-closed: 0
    emergency-bypassed: 50
  tcp:
    new: 60
    established: 3600
    closed: 120
    bypassed: 100
    emergency-new: 5
    emergency-established: 300
    emergency-closed: 20
    emergency-bypassed: 50
  udp:
    new: 30
    established: 300
    bypassed: 100
    emergency-new: 10
    emergency-established: 100
    emergency-bypassed: 50
  icmp:
    new: 30
    established: 300
    bypassed: 100
    emergency-new: 10
    emergency-established: 100
    emergency-bypassed: 50

# Stream engine settings. Here the TCP stream and reassembly engine is configured.
#
# stream:
#   memcap: 32mb                # Can be specified in kb, mb, gb.  Just a
#                               # number is parsed as bytes.
#   max-sessions: 262144       # 256k concurrent sessions
#   prealloc-sessions: 8192     # 8k sessions prealloc'd
#   midstream: false            # don't allow midstream session pickup
#   async-oneside: false        # don't enable async one side streams
#   inline: no                  # stream inline mode
#   reassembly:
#     memcap: 16mb              # Can be specified in kb, mb, gb.  Just a
#                               # number is parsed as bytes.
#     depth: 1mb                # Can be specified in kb, mb, gb.  Just a
#                               # number is parsed as bytes.
#     toserver-chunk-size: 2560 # inspect raw stream in chunks of. 0 disables.
#     toclient-chunk-size: 2560 # inspect raw stream in chunks of. 0 disables.
#     randomize-chunk-size: yes # randomize chunksize if possible
#     randomize-chunk-range: 10 # range of randomization (1 - value)
#
#     # Configure the depth of the stream reassembly for either direction.
#     # The depth is the maximum amount of data to be buffered for reassembly.
#     # When the buffer is full, the oldest data is discarded.
#     # The depth can be specified in kb, mb, gb.  Just a number is parsed as bytes.
#     #depth: 1mb
#     #toserver-chunk-size: 2560
#     #toclient-chunk-size: 2560
#     #randomize-chunk-size: yes
#     #randomize-chunk-range: 10

# Host table:
#
# Host table is used by the tagging and per host thresholding subsystems.
#
host:
  hash-size: 4096
  prealloc: 1000
  memcap: 16777216

# IP Pair table:
#
# IP Pair table is used by the tagging and per host pair thresholding subsystems.
#
host-pair:
  hash-size: 4096
  prealloc: 1000
  memcap: 16777216

# Logging configuration.  This is not about logging IDS alerts/events, but
# about Suricata internal logging.
logging:

  # The default log level: info
  default-log-level: info

  # The default output format.  Optional parameter, default is
  # "[%i] %t - (%f:%l) <%d> (%n) -- "
  #default-log-format: "[%i] %t - (%f:%l) <%d> (%n) -- "

  # A logging output, with a format close to "unified2"
  # default-unified2-format: "[%i] %t - event_type=\"%d\", event_id=%n %s"

  # Define your logging outputs.  If none are defined, or they are all
  # disabled you will get the default - console output.
  outputs:
  - console:
      enabled: yes
      # type: json
  - file:
      enabled: no
      level: info
      # type: json
      filename: /var/log/suricata/suricata.log
      #rotate-interval: minute
      #max-files: 10
  - syslog:
      enabled: no
      facility: local5
      format: "[%i] <%d> -- "
      # type: json

# Tilera mpipe configuration. for use on Tilera TILE-Gx.
mpipe:

  # Load balancing modes: "static", "dround-robin", "qround-robin"
  load-balance-mode: static

  # IPS cluster configuration (tile architecture only)
  ips:
    # Default cluster id.  FP clusters are automatically enabled if
    # a cluster id is set to non-zero.
    #default-cluster-id: 1

    # Supported IPS hash algorithms: "simple", "toeplitz"
    hash-algorithm: simple

    # IPS cluster configuration.  Each cluster can have a unique hash algorithm.
    # If not specified, the default hash algorithm is used.
    #clusters:
    #  - cluster-id: 1
    #    hash-algorithm: toeplitz

    # Configuration of flow packet distribution.
    #flow-packets:
    #  enabled: yes
    #  bucket-size: 79
    #  hash-algorithm: simple

  # Input pipeline configuration.
  inputs:
    - interface: xgbe1
    - interface: xgbe2

  # Output pipeline configuration.
  outputs:
    - interface: xgbe1
    - interface: xgbe2

# Cross platform libpcap capture support
pcap:
  # On Linux, pcap will try to use mmap'ed capture and will use "memory
  # mapped" rx/tx buffers as defined by pcap. On Windows mmap is not possible,
  # so pcap will use "regular" rx/tx buffers.
  #
  # On Linux, the buffer size will be computed based on snaplen, ring-size
  # and batch-size. On Windows, the buffer size will be 1600000 (1.6MB).
  #
  # You can override the buffer size with buffer-size. If you set the
  # buffer-size to 0, the default value will be used.
  #
  # Use buffer-size: 0 to set the buffer size to the default value.
  #
  # On Linux, pcap will use buffer-size as the pcap buffer size or the
  # value of the buffer-size * batch-size as the pcap buffer size.
  #
  # On Windows, pcap will use buffer-size as the pcap buffer size.
  #
  # The buffer-size can be specified in kb, mb, gb.  Just a number is parsed as bytes.
  #
  #buffer-size: 1gb

  # On Linux only, the buffer size can be computed from the snaplen, ring-size
  # and batch-size. If buffer-size is set, this computation is not used.
  #
  #snaplen: 1518
  #ring-size: 2048
  #batch-size: 1

  # Use buffer-size: 0 to set the buffer size to the default value.
  #
  #buffer-size: 0

  # On Linux only, the buffer size can be computed from the snaplen, ring-size
  # and batch-size. If buffer-size is set, this computation is not used.
  #
  #snaplen: 1518
  #ring-size: 2048
  #batch-size: 1

# AF_PACKET support
# Set threads to > 1 to use PACKET_FANOUT. When using Fanout, pcap files
# and output will be handled by the same thread, so there shouldn't be any
# performance degradation.
af-packet:
  - interface: eth0
    # Number of receive threads (>1 will enable packet_fanout)
    threads: 1
    # Default clusterid.  FP clusters are automatically enabled if
    # a cluster id is set to non-zero.
    #cluster-id: 99
    # Default AF_PACKET cluster type. FP clusters are automatically enabled if
    # a cluster id is set to non-zero.
    #cluster-type: cluster_flow
    # In some fragmentation cases, the hash can not be computed. If "defrag" is
    # set to yes, the kernel will do the needed defragmentation before the
    # packet is passed to the interface.
    defrag: yes
    # To use the ring feature of AF_PACKET, set 'use-mmap' to yes
    use-mmap: yes
    # Ring size will be computed with respect to the maximum size of packet
    # and number of ring slots. You can set manually the ring size in number
    # of slots. This must be a power of 2.
    #ring-size: 2048
    #block-size: 32768
    #block-timeout: 10
    # On busy systems, the capture kernel can 't see the load of the
    # inspection threads. For those cases setting the checksum validation
    # off-loading to 'no' can fix that.
    #use-emergency-flush: yes
    #copy-mode: ips
    #copy-iface: eth1
  # Put default values here. If copy-mode is set to ips or tap, the copy-iface
  # will be created and default values from above are copied here. These
    # values can be overridden.
  - interface: default
    #threads: 1
    #use-mmap: yes

# PF_RING configuration. for use with native PF_RING support
# for more info see http://www.ntop.org/products/pf_ring/
pfring:
  - interface: eth0
    # Number of receive threads (>1 will enable packet_fanout)
    threads: 1

    # Default clusterid.  FP clusters are automatically enabled if
    # a cluster id is set to non-zero.
    cluster-id: 99

    # Default PF_RING cluster type. FP clusters are automatically enabled if
    # a cluster id is set to non-zero.
    cluster-type: cluster_flow
  # Put default values here
  - interface: default
    #threads: 1

# Netmap support
netmap:
   - interface: eth0
     # Number of worker threads. Netmap will use the number of CPU's
     threads: 1
     # Copy mode
     #copy-mode: ips
     #copy-iface: eth1
   - interface: default
     #threads: 1

# For FreeBSD ipfw(4) divert(4) support.
# Please make sure you have ipfw_load="YES" and ipdivert_load="YES"
# in /boot/loader.conf or kldload'd.
ipfw:

  # Reinject packets at the divert port.
  # This is location where packets are reinjected after being processed.
  #reinject-port: 8000

  # Inject packets at the divert port (ipfw capture).
  # This is the port where packets picked up by ipfw are send after
  # being processed by suricata.
  #inject-port: 8001

# Set the default rule path here to search for the files.
# if not set, it will look at the current working dir
default-rule-path: /etc/suricata/rules

rule-files:
 - suricata.rules

classification-file: /etc/suricata/rules/classification.config
reference-config-file: /etc/suricata/rules/reference.config

# Holds variables that would be used by the engine.
vars:

  # Holds the address group vars that would be passed in a Signature.
  # These would be retrieved during the Signature address parsing stage.
  address-groups:
    HOME_NET: "[192.168.0.0/16,10.0.0.0/8,172.16.0.0/12]"

    EXTERNAL_NET: "!$HOME_NET"

    HTTP_SERVERS: "$HOME_NET"

    SMTP_SERVERS: "$HOME_NET"

    SQL_SERVERS: "$HOME_NET"

    DNS_SERVERS: "$HOME_NET"

    TELNET_SERVERS: "$HOME_NET"

    AIM_SERVERS: "$EXTERNAL_NET"

    DC_SERVERS: "$HOME_NET"

    DNP3_SERVER: "$HOME_NET"

    DNP3_CLIENT: "$HOME_NET"

    MODBUS_CLIENT: "$HOME_NET"

    MODBUS_SERVER: "$HOME_NET"

    ENIP_CLIENT: "$HOME_NET"

    ENIP_SERVER: "$HOME_NET"

  # Holds the port group vars that would be passed in a Signature.
  # These would be retrieved during the Signature port parsing stage.
  port-groups:
    HTTP_PORTS: "80"

    SHELLCODE_PORTS: "!80"

    ORACLE_PORTS: 1521

    SSH_PORTS: 22

    DNP3_PORTS: 20000

    MODBUS_PORTS: 502

    FILE_DATA_PORTS: "[$HTTP_PORTS,110,143]"

    FTP_PORTS: 21

    GENESIS_PORTS: 1000

    VIN_PORTS: 10001

    LSCP_PORTS: 10001

    ENIP_PORTS: 44818

# Set the order of alerts based on actions
# The default order is pass, drop, reject, alert
action-order:
  - pass
  - drop
  - reject
  - alert

# IP Reputation
#reputation-categories-file: /etc/suricata/rules/iprep/categories.txt
#default-reputation-path: /etc/suricata/rules/iprep
#reputation-files:
# - reputation.list

# Host specific policies for defragmentation and TCP stream reassembly
host-os-policy:
  # Make the default policy windows.
  windows: [0.0.0.0/0]
  bsd: []
  bsd-right: []
  old-linux: []
  linux: [10.0.0.0/8, 192.168.1.100, "8762:2352:6241:7245:E000::/66"]
  old-solaris: []
  solaris: ["::1"]
  hpux10: []
  hpux11: []
  irix: []
  macos: []
  vista: []
  windows2k3: []

# Limit the number of alert per second by connection and by IP.
#rate-filter:
#  # The rate filter is used to limit the number of alerts per second by
#  # connection and by IP. The rate filter is applied after the signature
#  # has been matched.
#
#  # The rate filter can be used to limit the number of alerts per second
#  # by connection and by IP. The rate filter is applied after the signature
#  # has been matched.
#
#  # The rate filter can be used to limit the number of alerts per second
#  # by connection and by IP. The rate filter is applied after the signature
#  # has been matched.
#
#  # gen-id: 1
#  # sig-id: 1
#  # tracker-type: src
#  # tracker-value: 0
#  # rate: 10
#  # new-action: alert
#  # timeout: 10
#  # burst: 5
#  # repeat: 1
#  # invert: false
#  # count: 1
#  # seconds: 60
#  # gap: 0
#  # threshold-type: limit
#  # threshold: 1
#  # window: 0

# Event correlation.
#event-correlation:
#  enabled: yes
#  # How long to keep events in memory to correlate them
#  # (in seconds). Default is 30 seconds.
#  timeout: 30
#  # How many events to keep in memory for correlation.
#  # Default is 1000.
#  max-pending-events: 1000
#  # How many events to keep in memory for correlation per IP.
#  # Default is 100.
#  max-pending-events-per-ip: 100

# GeoIP2
#geoip2:
#  # Specify the database file path.
#  #database: /usr/local/share/GeoIP/GeoLite2-City.mmdb
#  # Specify the database file path for the ASN database.
#  #asn-database: /usr/local/share/GeoIP/GeoLite2-ASN.mmdb
#  # Specify the database file path for the country database.
#  #country-database: /usr/local/share/GeoIP/GeoLite2-Country.mmdb

# ASN1 and BER decoding settings
asn1-max-frames: 256

# Engine output 'external' support.  Exposes internal functions to Lua
# scripts or other external systems using JSON messages.
#external:
#  # enabled: no
#  # filename: external.lua
#  # filetype: lua

# Metadata:
# Metadata is an array of key value pairs. The key value pairs are added to
# the metadata array in the EVE output. The key value pairs are added to the
# metadata array in the EVE output. The key value pairs are added to the
# metadata array in the EVE output.
#metadata:
#  - key: value
#  - key2: value2

# Include files
#include: include1.yaml
#include: include2.yaml